<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pool Table</title>
    <script src="build/poolsim.js"></script>
  </head>
  <body>
    <canvas id="canvas" width="600" height="600">Upgrade your browser.</canvas>

    <script>
    const game = new poolsim.Game();

    function drawTable() {
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.save();
      ctx.translate(100, 100);
      ctx.scale(400, 400);
      game.table.draw(ctx);
      ctx.restore();
    }

    let interval;
    interval = setInterval(() => {
      if (game.winner() !== null) {
        alert('winner is ' + game.winner());
        clearInterval(interval);
        return;
      }
      if (game.actionType() === null) {
        game.step(1 / 24);
      } else {
        game.act(game.actionType().sample());
      }
      drawTable();
    }, 1000 / 24);
    </script>
  </body>
</html>
